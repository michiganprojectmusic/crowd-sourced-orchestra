<head>
  <script src="https://www.gstatic.com/firebasejs/4.3.0/firebase.js"></script>
</head>

<html>
  <body>
    <input oninput="outputInputFrequency()" type="range" id="range" min="65" max="1046" value="440" style="width:100%;"/>
    <p id="currentFrequency">Current Frequency: </p>
    <input id="name" placeholder="Uniqname"></input>
    <button onmousedown="sendToFirebase()" onmouseup="stopToFirebase()">Input Sound</button> </p>
    <input type="radio" name="waveform" value="Sine" checked> Sine<br>
    <input type="radio" name="waveform" value="Triangle"> Triangle<br>
    <input type="radio" name="waveform" value="Square"> Square
  </body>
</html>

<script>
  //FIREBASE CONFIG
  let config = {
    apiKey: "AIzaSyDdhydpdWwubaZbnzRvGQUtPUIi2U4wgD8",
    authDomain: "crowd-sourced-orchestra.firebaseapp.com",
    databaseURL: "https://crowd-sourced-orchestra.firebaseio.com/"
  };

  //FIREBASE INITIALIZATION
  firebase.initializeApp(config);

  let database = firebase.database();
  let userId = "O2mic17G1BWYQpLvxSkemouJIeC3";

  //VARIABLE INITIALIZATION
  var frequency = document.getElementById("range").value;
  var wave = "Sine";
  outputInputFrequency();

  //CONSTANTLY UPDATES FREQUENCY WHENEVER THERE IS INTERACTION
  function outputInputFrequency() {
    frequency = document.getElementById("range").value;
    document.getElementById("currentFrequency").innerHTML = "Current Frequency: " + frequency;
  }

  function sendToFirebase() {
    //GET NAME FROM INPUT FIELD
    name = document.getElementById("name").value;

    //GET WAVEFORM
    waveforms = document.getElementsByName("waveform");
    
    for (var i = 0, length = waveforms.length; i < length; i++) {
    if (waveforms[i].checked) {
        // do whatever you want with the checked radio
        wave = waveforms[i].value;

        // only one radio can be logically checked, don't check the rest
        break;
    }
}
    //ERROR CHECKING
    if (name == "") {
      alert("Input Your Uniqame");
      return;
    }

    //IF NO ERRORS SEND
    else {
      database.ref('users/' + name).set({
        freq: frequency,
        type: wave,
        active: true
        
      });
    }
  }

function stopToFirebase() {
  name = document.getElementById("name").value;

    //ERROR CHECKING
    if (name == "") {
      //alert("Input Your Uniqame"); Double Alert
      return;
    }

    //IF NO ERRORS SEND
    else {
      database.ref('users/' + name).set({
        freq: frequency,
        type: wave,
        active: false
      });
    }
}

</script>
